# D3keyHelper
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

D3KeyHelper是一个有图形界面，可自定义配置的暗黑3自动宏工具。

运行代码请使用最新版的AHK软件，所有测试在v1.1.33.06版本下运行通过。

## 主界面
![plot](./mainwindow.png)

1. 右上角设置战斗宏启动快捷键。可以为鼠标或者键盘按键。因为暗黑3的默认强制站立键为左Shift，玩家在设置所有宏相关快捷键时应避免使用Shift键，以免出现bug！
2. 按键宏设置区域可以设置具体的战斗宏：
   1. 设置对应的技能快捷键，除了鼠标左右键无法更改外其他都可以自定义。
   2. 设置对应按键的执行策略，目前支持的可能策略有：
      1. 按住该键不放（按住不放）。
      2. 固定时间间隔点击（连点）。
      3. 保持Buff模式（保持buff）。保持buff只能针对有绿条buff的技能，比如法师电盾，DH烟雾弹。宏会自动检测游戏分辨率并获取相关像素点的颜色信息，平时并不作为，只在buff快消失时点击续上buff。
   3. 设置具体各个策略的执行间隔，最少20毫秒，最多30秒运行一次。
   4. 最后可以为连点策略加入随机延迟。这里设置为0可以关闭延迟。
3. 额外设置区域包含一些和可以继续提升游戏体验的辅助功能：
   1. 快速切换：设置一个按键快速切换到本配置。
   2. 走位辅助：可设置为强制站立，或者强制走位。
   3. 宏启动方式：懒人模式（按一下开，再按一下关）。仅按住时（字面意思）。
   4. 使用单线程按键队列：开启后，因连点，保持buff所产生的按键不会立即按下，而是加入到一个按键队列中。连点会使得按键加入队列的头部，保持buff会加入队列的尾部。最后按键队列里的按键再按照固定的时间间隔一一发送至游戏。此功能主要配合冰吞使用，可以解决冰吞因为前后摇无法续上buff的问题。但是开启后会造成而外的按键延迟，非冰吞请勿开启。
   5. 快速暂停：按下对应鼠标键时可以短时间暂停压键。因为游戏本身设计中当有按键长按时会屏蔽鼠标左键。开启这项功能可以缓解无法点门，无法点祭坛的情况。
4. 右侧设置通用的辅助功能：
   1. 设置助手快捷键。程序会自动猜测用户的目的从而执行对应的策略。同时助手宏的启动方式和战斗宏的懒人模式类似，按一下开启，再按一下可以打断当前宏。
   2. 助手宏动画速度：可以调节鼠标移速，等待间隔。根据自身网络，电脑情况选择。
   3. 赌博助手（出现赌博界面时开启）：按下助手快捷键时即按下x次右键。
   4. 分解助手（出现分解页面时开启）:
      1. 快速分解，按下即等于左键点击+自动回车。
      2. 一键分解，按下自动分解背包内所有能分解，不处在安全格中的物品。
      3. 智能分解，和一键分解一样，但会跳过远古，太古（开发中，目前不可用。。。）
   5. 升级助手：自动升级背包内所有黄装（开发中，目前不可用。。。）
   6. 重铸助手：重铸指定传奇一次（开发中，目前不可用。。。）
   7. 使用快捷键切换配置成功时播放声音（字面意思）。
   8. 智能暂停：按下tab键时暂停宏，按下回车，回城（T），地图（M）时停止宏。
   9. 更多整合功能开发中。

## 配置文件
![plot](./settings.png)

软件在打开时会自动载入同目录下的d3oldsand.ini配置文件。若无该配置文件，软件会套用默认设置并在下一次关闭，退出时创建该配置文件。
配置文件可以用任意文本编辑器打开并修改，开头的General区块存放和程序本身相关的一些配置。可以自行在此配置和一键宏相关的安全区域（safezone）
safezone中的格子不会受到一键宏的影响。配置格式为英文逗号分隔的格子编号。具体编号与游戏背包格子的对应如下：
![plot](./safezone.png)

随后的各个区块都对应具体的配置。因此可以通过重命名。增加，或者减少区块来控制软件中配置的显示。

配置文件可以分享给其他玩家。
