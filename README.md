# D3keyHelper
D3KeyHelper是一个有图形界面，可自定义配置的暗黑3自动宏工具。

运行代码请使用最新版的AHK软件，所有测试在v1.1.33.06版本下运行通过。

## 主界面
![plot](./mainwindow.png)

1. 设置按键启动快捷键。因为暗黑3的默认强制站立键为左Shift，玩家在设置所有宏相关快捷键时应避免使用Shift键，以免出现bug！
2. 这里设置对应的按键宏。
   1. 设置对应的技能快捷键，除了鼠标左右键无法更改外其他都可以自定义。
   2. 设置对应按键的执行策略，目前支持的可能策略有：
      1. 按住该键不放（按住不放）。
      2. 固定时间间隔点击（连点）。
      3. 保持Buff模式（保持buff）。保持buff只能针对有绿条buff的技能，比如法师电盾，DH烟雾弹。宏会自动检测游戏分辨率并获取相关像素点的颜色信息，在buff快消失时点击续上buff。
   3. 这里设置具体各个策略的执行间隔，最少20毫秒，最多30秒运行一次。
   4. 最后可以为连点策略加入随机延迟。这里设置为0可以关闭延迟。
3. 额外设置区块包含一些和当前按键宏相关的辅助功能：
   1. 快速切换：设置一个按键快速切换到本配置。
   2. 走位辅助：可设置为强制站立（按住左Shift键），或者强制走位（根据间隔按下e键）。当选择强制走位时可以设置e键按下的间隔，当间隔小于20毫秒时e键会变成一直按下。
   3. 宏启动方式：懒人模式（按一下开，再按一下关）。仅按住时（字面意思）。
   4. 快速暂停：按下对应鼠标键时可以短时间暂停压键。因为游戏本身设计中当有按键长按时会屏蔽鼠标左键。开启这项功能可以缓解无法点门，无法点祭坛的情况。
4. 这里设置其他的辅助功能：
   1. 设置助手快捷键。程序会自动猜测用户的目的从而执行对应的策略。
   2. 赌博助手：按下快捷键时即按下x次右键。
   3. 分解助手:
      1. 快速分解，按下即等于左键点击+回车。
      2. 一键分解，按下自动分解背包内所有物品（开发中，目前不可用。。。）
      3. 智能分解，和一键分解一样，但会跳过远古，太古（开发中，目前不可用。。。）
   4. 升级助手：自动升级背包内所有黄装（开发中，目前不可用。。。）
   5. 重铸助手：重铸指定传奇一次（开发中，目前不可用。。。）
   6. 使用快捷键切换配置成功时播放声音。开启后游戏内切换配置时会有提示音。
   7. 智能暂停：按下tab键时暂停宏，按下回车，回城（T），地图（M），技能（S）时停止宏。
   8. 更多整合功能开发中。

## 配置文件
![plot](./settings.png)

软件在打开时会自动载入同目录下的d3oldsand.ini配置文件。若无该配置文件，软件会套用默认设置并在下一次关闭，退出时创建该配置文件。

配置文件可以用任意文本编辑器打开并修改，开头的General区块存放和程序本身相关的一些配置。随后的各个区块都对应具体的配置。因此可以通过重命名。增加，或者减少区块来控制软件中配置的显示。

配置文件可以分享给其他玩家。
